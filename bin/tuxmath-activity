#!/bin/sh
###############################################################################
#
#    Script to start Tuxmath from Sugar
#
#    Author:     Marcos Orfila - www.marcosorfila.com
#
#    Last modified:  Jan 22nd, 2010 (Marcos Orfila)
#
###############################################################################

while [ -n "$2" ] ; do
    case "$1" in
      	-b | --bundle-id)     export SUGAR_BUNDLE_ID="$2" ;;
      	-a | --activity-id)   export SUGAR_ACTIVITY_ID="$2" ;;
      	-o | --object-id)     export SUGAR_OBJECT_ID="$2" ;;
	-u | --uri)           export SUGAR_URI="$2" ;;
	*) echo unknown argument $1 $2 ;;
    esac
    shift;shift
done
export NET_WM_NAME="Tuxmath"

[ -z "$SUGAR_BUNDLE_PATH" ] && export SUGAR_BUNDLE_PATH="."
export LD_PRELOAD="$SUGAR_BUNDLE_PATH/lib/libsugarize.so"
export LD_LIBRARY_PATH="$SUGAR_BUNDLE_PATH/lib"

[ -z "$SUGAR_PROFILE" ] && SUGAR_PROFILE=default
[ -z "$SUGAR_ACTIVITY_ROOT" ] && SUGAR_ACTIVITY_ROOT="$HOME/.sugar/$SUGAR_PROFILE/tuxmath"
TUX_HOMEDIR="$SUGAR_ACTIVITY_ROOT/tux_homedir"
umask 0002
[ ! -d "$TUX_HOMEDIR" ] && mkdir -p "$TUX_HOMEDIR"

[ ! -e bin/tuxmath ] && sh ./daxme.sh 

exec bin/tuxmath \
	--homedir $TUX_HOMEDIR \
	--fullscreen

